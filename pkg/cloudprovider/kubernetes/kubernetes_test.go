/*
Copyright 2017 The Elasticshift Authors.
*/
package kubernetes

import (
	"encoding/base64"
	"encoding/json"
	"fmt"
	"testing"
)

var confEncoded = `YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eTogL1VzZXJzL2doYXpuaS8ubWluaWt1YmUvY2EuY3J0CiAgICBzZXJ2ZXI6IGh0dHBzOi8vMTkyLjE2OC45OS4xMDA6ODQ0MwogIG5hbWU6IG1pbmlrdWJlCi0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSVmVrTkRRV3AxWjBGM1NVSkJaMGxLUVU1cVVtcFhVMGQwT0ZFNVRVRXdSME5UY1VkVFNXSXpSRkZGUWtOM1ZVRk5RMEY0U0dwQlkwSm5UbFlLUWtGTlRVWlVSWGRNYWtrd1RsTTBlRXhxU2tGTlZGRXhUMVJOZDA1VVVURk9la0ZsUm5jd2VFNXFRWHBOZWtGM1RXcE5NMDE2WkdGR2R6QjVUbXBCZWdwTmFtZDNUV3BOTTAxNlpHRk5RMEY0U0dwQlkwSm5UbFpDUVUxTlJsUkZkMHhxU1RCT1V6UjRUR3BLUVUxVVVURlBWRTEzVGxSUk1VNTZRME5CVTBsM0NrUlJXVXBMYjFwSmFIWmpUa0ZSUlVKQ1VVRkVaMmRGVUVGRVEwTkJVVzlEWjJkRlFrRk9UbEZFYkd4clJHbEVVbE5qV0d4bE5tcG5kbk5rWkV4UVdFc0tXalZFY2taaGRGUXZTbXQ1ZUhoSE1FbHRVMWMxVFVSNVVreEJha1ZZYlVSa1N6SkVPWEpuWTA5cVFXcEZWR3hxTW1SbVpHZEVLMlJRT0c5VlZ6RlBSUXBqWkV0M2NIUldlbGhDVW5WM1ZHbFhZeTl6VjNOa1lWcHdkRTFDWWxKQ1ZVOXdibmhrWWs5Tk0yTlpSMUpQV1VacWEySlNLMFowVTFoVk1tcFFkakkwQ2pKM1JtWlRRM05oV0VzMVVVY3pibkJWUjJKa1NUaFRiblJoYWpGSGJ5dEhTVU5qTUd4TVR6VXhXa2RWVW5KUFR5dDZNMU4wTlRad1NtZFRVM1JWUkVNS1RDdEhNekZtWmxBMVNraHdSMVZLTmtKR2F6VjBUVUpJVW5kMlRYUnFaeXRJV2tjdmNsVnRSRFFyZGpoNldVeEtVRlV3UmtSNk5sRTNlRlJPUjJoTlp3cHpOVE5PWnpkR2JXMWljRE4yT0hKUlJGcEZWM05sTUhkTFltY3dORWhEWWxVclVUTlBVa3BEVEZGeWVqQllURmxRVkVVcldGZDBZMWxvT0VOQmQwVkJDa0ZoVDBKcWVrTkNha1JCWkVKblRsWklVVFJGUm1kUlZXZEdhV1JXYjNKdk1YWnhUVEZKT1V4UlZtc3JWR1ZQTVRKcWIzZFZRVmxFVmxJd2FrSkZhM2NLVWpSQlZXZEdhV1JXYjNKdk1YWnhUVEZKT1V4UlZtc3JWR1ZQTVRKcWNXaEtTMUZwVFVOQmVFaHFRV05DWjA1V1FrRk5UVVpVUlhkTWFra3dUbE0wZUFwTWFrcEJUVlJSTVU5VVRYZE9WRkV4VGpSSlNrRk9hbEpxVjFOSGREaFJPVTFCZDBkQk1WVmtSWGRSUmsxQlRVSkJaamgzUTNkWlJGWlNNRkJDUVZGRUNrRm5SVWROUVRCSFExTnhSMU5KWWpORVVVVkNRM2RWUVVFMFNVSkJVVU5xVW5WUldGTndkRWRFVDJVdmQxaHFhbXR6UkVGUVRUWkxkVEJ6V0RGWFowNEtSMjFUUkd4WmRHUkhWR1JvZWxCelFsaDNXbm96ZWpKa1RuSmFlWFJwTlhWbFVtazJaMWMwYUZaVVlVbzRSRFp1YUc5UVUwRTJPVUoyWVVsWGQwNW1id3BNZFU5eEsyZHFXV2RaTjNoa1JIQnRlbmQwTTFCb2RIZFBNMU5GWVZwSmN5OXZjMGxsV2pCWlJGZFRUMEpGTWsxSE9URnhWV1pTWWtRNWNrZGFRMmQyQ25STGRUUlVSV0UzWnpCVGVVaG9VR3BMY1VKVE9XMWhZbGQxTUN0VVIzQTVlVXBHVFhaV2FGY3dabmx3YkM5cU1TdHZZMFJzTjFKTGIzbHJjSFJzYm5NS1pUbFFiVmQzVUNzeUt6UlliR1pJTVhrelZqTlJlVkJNYVdodFpqbFhVMGQwVGpGbmJWSk5kVkZQZUc1NlRraG9MMmM1YUdFNU16ZHJMMWx0YjFjeWNncFhVRVpLWkZabWFXOHlUeTlQZDNNd0wxTTJia3hWV1dOMFZtNURiWGxQYjFaUVJuRjZOMWh6YkZOVk5ETk9ZVTQwVUcxYUNpMHRMUzB0UlU1RUlFTkZVbFJKUmtsRFFWUkZMUzB0TFMwSwogICAgc2VydmVyOiBodHRwczovLzEwLjI0NS4xLjIKICBuYW1lOiB2YWdyYW50CmNvbnRleHRzOgotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiBtaW5pa3ViZQogICAgdXNlcjogbWluaWt1YmUKICBuYW1lOiBtaW5pa3ViZQotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiB2YWdyYW50CiAgICB1c2VyOiB2YWdyYW50CiAgbmFtZTogdmFncmFudApjdXJyZW50LWNvbnRleHQ6IG1pbmlrdWJlCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZTogbWluaWt1YmUKICB1c2VyOgogICAgYXMtdXNlci1leHRyYToge30KICAgIGNsaWVudC1jZXJ0aWZpY2F0ZTogL1VzZXJzL2doYXpuaS8ubWluaWt1YmUvY2xpZW50LmNydAogICAgY2xpZW50LWtleTogL1VzZXJzL2doYXpuaS8ubWluaWt1YmUvY2xpZW50LmtleQotIG5hbWU6IHZhZ3JhbnQKICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IFEyVnlkR2xtYVdOaGRHVTZDaUFnSUNCRVlYUmhPZ29nSUNBZ0lDQWdJRlpsY25OcGIyNDZJRE1nS0RCNE1pa0tJQ0FnSUNBZ0lDQlRaWEpwWVd3Z1RuVnRZbVZ5T2lBeUlDZ3dlRElwQ2lBZ0lDQlRhV2R1WVhSMWNtVWdRV3huYjNKcGRHaHRPaUJ6YUdFeU5UWlhhWFJvVWxOQlJXNWpjbmx3ZEdsdmJnb2dJQ0FnSUNBZ0lFbHpjM1ZsY2pvZ1EwNDlNVEF1TWpRMUxqRXVNa0F4TkRVNU16QTFORFUzQ2lBZ0lDQWdJQ0FnVm1Gc2FXUnBkSGtLSUNBZ0lDQWdJQ0FnSUNBZ1RtOTBJRUpsWm05eVpUb2dUV0Z5SURNd0lEQXlPak0zT2pNM0lESXdNVFlnUjAxVUNpQWdJQ0FnSUNBZ0lDQWdJRTV2ZENCQlpuUmxjaUE2SUUxaGNpQXlPQ0F3TWpvek56b3pOeUF5TURJMklFZE5WQW9nSUNBZ0lDQWdJRk4xWW1wbFkzUTZJRU5PUFd0MVltVmpabWNLSUNBZ0lDQWdJQ0JUZFdKcVpXTjBJRkIxWW14cFl5QkxaWGtnU1c1bWJ6b0tJQ0FnSUNBZ0lDQWdJQ0FnVUhWaWJHbGpJRXRsZVNCQmJHZHZjbWwwYUcwNklISnpZVVZ1WTNKNWNIUnBiMjRLSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRkIxWW14cFl5MUxaWGs2SUNneU1EUTRJR0pwZENrS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUUxdlpIVnNkWE02Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ01EQTZZV1E2WXpBNk0ySTZZV002TmprNk9ESTZOR0U2T0RrNlptTTZNbVE2TVRNNk9XUTZOek02T0dFNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdNVEk2TkRnNlpEazZNMkk2WTJVNk56UTZOVGc2TWpNNk5UVTZaR0k2T0dJNk5qazZOV1U2WkRZNlptVTZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWVdZNllqWTZaalE2WVRRNllqVTZNR0U2Tm1ZNlpqSTZOek02TmpRNk5tUTZZV1U2TVdFNk5HRTZPVEE2Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ09URTZNemM2T0RFNlpEZzZZMlk2TmpJNk9EUTZaVE02T1RjNlptSTZOVFE2WVRZNk9ERTZNVEU2WW1FNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdNVFU2WTJJNk1qQTZPREU2TURnNlkyTTZaR1E2WWpnNk1UazZaak02TkdNNlpUWTZZelU2WW1FNk5USTZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnTkRJNk56TTZNVGs2TkRRNlkyRTZZV0U2WkdFNk9XRTZZVEU2WkdNNlpqSTZOV0k2WVRNNk5qUTZaakE2Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1pqYzZNbUU2TTJZNllUYzZaVGM2TmprNlpEVTZPV1k2TUdRNlptRTZORE02WVRnNk5qSTZNV0U2WlRBNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdPV1k2TlRNNk1EQTZOVFE2WmpjNk1tUTZNR1U2TUdFNk5XSTZNREE2WkRJNlpXVTZNems2WWprNk56ZzZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWldNNk1HRTZOams2WVRrNk5HRTZaRFk2TmpFNlkyUTZOVEE2WldFNk5XWTZPV1E2WlRNNllXSTZaREk2Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ05qTTZZems2TmpJNk1HSTZNbU02WkRFNk1UQTZPREU2TWprNk5HRTZNekE2WXprNk1qQTZNems2WWpBNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdOems2WW1NNk9HVTZZVFU2TlRVNk1HSTZOMlk2TkdRNk5USTZOVFE2T1dNNk9USTZZVFU2TVRJNlpETTZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnTkRRNlpqazZOMlU2WmpFNk5qVTZNREU2WVRFNk4yVTZORFk2Tm1NNlpUazZZVEU2TVdRNk5qQTZaV1U2Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1lUTTZOekU2WVRZNlpEVTZaakE2TmpVNlkyRTZaamc2WmpnNk5UYzZOVFk2TW1RNk5XWTZZVEk2TTJZNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdOV1k2TmpJNllXRTZOemM2TW1FNllXWTZZekE2WldRNk9EQTZaV0U2WVRFNk1XTTZaRE02TXpNNk9HRTZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnWW1JNk5qZzZZVFU2T0RZNk16azZOakU2WlRJNlpXRTZZVGc2TkdZNk1EazZNVFE2T1RRNllXTTZOMlU2Q2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ1pETTZNMlU2TmpVNk5tTTZOREE2TVRBNk5qZzZaVGc2WVRBNk1ESTZOelU2TURBNlpUazZZV1E2WXpVNkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdOREU2T1dNNlpHUTZZamM2Wm1VNk1tUTZPVEE2TkRBNk1ERTZZV1U2T1RVNk56QTZaV002WkRBNk5UQTZDaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnTlRNNk5XUUtJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lFVjRjRzl1Wlc1ME9pQTJOVFV6TnlBb01IZ3hNREF3TVNrS0lDQWdJQ0FnSUNCWU5UQTVkak1nWlhoMFpXNXphVzl1Y3pvS0lDQWdJQ0FnSUNBZ0lDQWdXRFV3T1hZeklFSmhjMmxqSUVOdmJuTjBjbUZwYm5Sek9pQUtJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lFTkJPa1pCVEZORkNpQWdJQ0FnSUNBZ0lDQWdJRmcxTURsMk15QlRkV0pxWldOMElFdGxlU0JKWkdWdWRHbG1hV1Z5T2lBS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSURORk9qZENPa1kyT2tSQk9qRTJPa1kyT2pFNE9rTkRPa1EyT2pnM09qWkVPak5DT2taR09rSTRPamxCT2tJMU9qWTFPamd6T2pNNU9qaEJDaUFnSUNBZ0lDQWdJQ0FnSUZnMU1EbDJNeUJCZFhSb2IzSnBkSGtnUzJWNUlFbGtaVzUwYVdacFpYSTZJQW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdhMlY1YVdRNk9EQTZOVGc2T1VRNk5UWTZPRUU2UlRnNlJEWTZSa0U2T0VNNlJEUTZPRVk2TkVJNk5ERTZOVGs2TTBVNk5FUTZSVE02UWpVNlJFRTZNMEVLSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJRVJwY2s1aGJXVTZMME5PUFRFd0xqSTBOUzR4TGpKQU1UUTFPVE13TlRRMU53b2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ2MyVnlhV0ZzT2tRNE9rUXhPamhFT2pZME9qZzJPa0kzT2tNME9qTkVDZ29nSUNBZ0lDQWdJQ0FnSUNCWU5UQTVkak1nUlhoMFpXNWtaV1FnUzJWNUlGVnpZV2RsT2lBS0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUZSTVV5QlhaV0lnUTJ4cFpXNTBJRUYxZEdobGJuUnBZMkYwYVc5dUNpQWdJQ0FnSUNBZ0lDQWdJRmcxTURsMk15QkxaWGtnVlhOaFoyVTZJQW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdSR2xuYVhSaGJDQlRhV2R1WVhSMWNtVUtJQ0FnSUZOcFoyNWhkSFZ5WlNCQmJHZHZjbWwwYUcwNklITm9ZVEkxTmxkcGRHaFNVMEZGYm1OeWVYQjBhVzl1Q2lBZ0lDQWdJQ0FnSURneU9qTTVPbU0xT21Vek9qUTBPakJoT21ZMk9qZzJPbUV6T2pjNU9tWXdPbUpoT2pNMk9tSXpPak00T2pjMU9qZ3pPamhtT2dvZ0lDQWdJQ0FnSUNCak5qb3lOem96TmpwaU1EbzJNRG96TVRveU1UbzJaVHBqWlRvM05Eb3haanBpT0Rwa1l6cGpPRG96TkRwaU9UbzBaVG8xWVRvS0lDQWdJQ0FnSUNBZ056VTZOalU2TXpRNlpHRTZNbVk2TVRVNk4ySTZOak02TldVNk5HVTZOMlU2TW1JNk9XTTZPRGc2T0RnNk5qZzZaVFU2WkdZNkNpQWdJQ0FnSUNBZ0lERmxPamxsT2pjeE9qSmpPak5sT2pRNE9tWXlPbUkwT21FeU9qZG1PamMwT21SbE9qZGpPamswT2pFeE9tWmhPalpsT2pVMk9nb2dJQ0FnSUNBZ0lDQmxNam8zTlRvMk1UcGtPRG95T0RwaFlqb3pOVG94TnpveU56cGxOanBrWmpvek16bzNaRG94WkRvME1Ub3dOem94WmpvMll6b0tJQ0FnSUNBZ0lDQWdNbU02TURVNlpEUTZNbVU2WTJVNllUVTZOVFE2TjJJNk5UUTZOalE2T0RVNllXSTZOMkk2TldJNk5XWTZPR0U2Wm1VNk5ERTZDaUFnSUNBZ0lDQWdJRGxsT21OaE9tTTVPakU0T21KbE9qWXlPamt5T21RM09tUm1PalZqT2prNE9qRTVPbVEzT2psbU9tVXlPbVV6T2pabU9qUmtPZ29nSUNBZ0lDQWdJQ0JoWmpvNFpqcGtaanBsWXpvMVpUcGpNVG93WWpvd1l6cGhNRHBqTmpwa016bzVNRHBsWXpvNFpqbzRZam81TWpwbFpqcGxNem9LSUNBZ0lDQWdJQ0FnWldNNk1EYzZZVFE2T0dJNlpEWTZZVEE2TmprNlpqUTZNR1E2WldNNk9UQTZZV1E2TjJFNk1qQTZNR0k2WkdVNk5qSTZZakE2Q2lBZ0lDQWdJQ0FnSUdNMk9qWmpPbUUxT21SaU9tTXpPbUkxT2pjM09tTTNPak01T2pVM09qazJPbVZqT21GbE9tRXdPalJoT21RNE9qZ3dPamMzT2dvZ0lDQWdJQ0FnSUNBeE16cG1PRG8zWXpvNE5EcGhOenBsT0RwbU1UbzFPVG93TVRwbVl6b3hOam94WkRwaU9Ub3daVG8yTVRwbU1qb3hPRHBpTXpvS0lDQWdJQ0FnSUNBZ1l6ZzZPV1E2WXpFNllXRTZabUk2TTJFNllUSTZZMkU2TVRJNllUQTZZamc2WkRjNlpXSTZabU02TVRnNlpETTZPR0U2TURBNkNpQWdJQ0FnSUNBZ0lHSTNPakV6T21RMU9qVXhPbU5sT21GbU9qUTBPbUUwT2pZek9qUmtPakE0T2pVMk9tSmpPbVExT2pJd09qVm1PakptT21WaU9nb2dJQ0FnSUNBZ0lDQmhORHBrTVRwaVl6bzFNRHBsWXpwaE56cGpOem8xWWpvek1UcGpNRHBtWmpwbFpEbzVPRG8yT0Rvd056bzBOVHBpT0RwbFpEb0tJQ0FnSUNBZ0lDQWdNV0U2TXpFNk1UUTZZamtLTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVUlVla05EUVdwbFowRjNTVUpCWjBsQ1FXcEJUa0puYTNGb2EybEhPWGN3UWtGUmMwWkJSRUZuVFZJMGQwaEJXVVJXVVZGRVJFSlZlRTFETkhrS1RrUlZkVTFUTkhsUlJFVXdUbFJyZWsxRVZUQk9WR04zU0doalRrMVVXWGROZWsxM1RVUkplazU2VFROWGFHTk9UV3BaZDAxNlNUUk5SRWw2VG5wTk13cFhha0ZUVFZKQmQwUm5XVVJXVVZGRVJFRmtjbVJYU214Wk1scHVUVWxKUWtscVFVNUNaMnR4YUd0cFJ6bDNNRUpCVVVWR1FVRlBRMEZST0VGTlNVbENDa05uUzBOQlVVVkJjbU5CTjNKSGJVTlRiMjQ0VEZKUFpHTTBiMU5UVG1zM2VtNVNXVWt4V0dKcE1teGxNWFkyZG5SMlUydDBVWEIyT0c1T2EySmhOR0VLVTNCRFVrNDBTRmw2TWt0Rk5EVm1OMVpMWVVKRlltOVdlWGxEUWtOTmVtUjFRbTU2VkU5aVJuVnNTa05qZUd4RmVYRnlZVzF4U0dNNGJIVnFXbEJFTXdwTGFpdHVOVEp1Vm01M016WlJObWhwUjNWRFpsVjNRbFU1ZVRCUFEyeHpRVEIxTkRWMVdHcHpRMjF0Y0ZOMFdtaDZWa1J4V0RVemFuRTVTbXA1VjBsTUNreE9SVkZuVTJ4TFRVMXJaMDlpUWpWMlNUWnNWbEYwTDFSV1NsVnVTa3RzUlhST1JTdFlOM2hhVVVkb1ptdGFjelpoUldSWlR6WnFZMkZpVmpoSFdFc0tLMUJvV0ZacE1XWnZhamxtV1hGd00wdHhMMEUzV1VSeGIxSjZWRTAwY1RkaFMxZEhUMWRJYVRaeGFGQkRVbE5WY2tnM1ZGQnRWbk5SUWtKdk5rdEJRd3BrVVVSd2NtTldRbTVPTWpNdmFUSlJVVUZIZFd4WVJITXdSa0pVV0ZGSlJFRlJRVUp2TkVkb1RVbEhaVTFCYTBkQk1WVmtSWGRSUTAxQlFYZElVVmxFQ2xaU01FOUNRbGxGUmtRMU56bDBiMWM1YUdwTk1XOWtkRTh2S3pSdGNsWnNaM3B0UzAxR1FVZEJNVlZrU1hkU1NrMUZaVUZHU1VKWmJsWmhTelpPWWpZS2FrNVRVRk13UmxwUWF6TnFkR1J2Tm05VFUydEpha0ZuVFZJMGQwaEJXVVJXVVZGRVJFSlZlRTFETkhsT1JGVjFUVk0wZVZGRVJUQk9WR3Q2VFVSVk1BcE9WR1ZEUTFGRVdUQlpNV3RvY21aRlVGUkJWRUpuVGxaSVUxVkZSRVJCUzBKblozSkNaMFZHUWxGalJFRnFRVXhDWjA1V1NGRTRSVUpCVFVOQ05FRjNDa1JSV1VwTGIxcEphSFpqVGtGUlJVeENVVUZFWjJkRlFrRkpTVFY0WlU1RlEzWmhSMjh6Ym5kMWFtRjZUMGhYUkdvNFdXNU9ja0puVFZOR2RYcHVVV1lLZFU1NlNVNU1iRTlYYmxac1RrNXZka1pZZEdwWWF6VXJTelY1U1dsSGFtd3plRFpsWTFOM0sxTlFTekJ2Ymprd00yNTVWVVZtY0hWV2RVb3hXV1JuYndweGVsVllTaXRpWmswek1HUlJVV05tWWtOM1JqRkROMDl3VmxJM1ZrZFRSbkV6ZEdKWU5ISXJVVm8zUzNsU2FTdFpjRXhZTXpGNVdVZGtaV1kwZFU1MkNsUmhLMUF6SzNobGQxRnpUVzlOWWxSclQzbFFhVFZNZGpRcmQwaHdTWFpYYjBkdU1FUmxlVkZ5V0c5blF6azFhWE5OV25Od1pIWkVkRmhtU0U5V1pWY0tOMHMyWjFOMGFVRmtlRkEwWmtsVGJqWlFSbHBCWm5kWFNHSnJUMWxtU1Zsek9HbGtkMkZ5TjA5eFRFdEZjVU0wTVN0Mk9FZE9UMHRCVEdOVU1WWklUd3B5TUZOcldUQXdTVlp5ZWxaSlJqaDJOalpVVW5aR1JITndPR1JpVFdORUx6ZGFhRzlDTUZjME4xSnZlRVpNYXowS0xTMHRMUzFGVGtRZ1EwVlNWRWxHU1VOQlZFVXRMUzB0TFFvPQogICAgY2xpZW50LWtleS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJRVWtsV1FWUkZJRXRGV1MwdExTMHRDazFKU1VWMlVVbENRVVJCVGtKbmEzRm9hMmxIT1hjd1FrRlJSVVpCUVZORFFrdGpkMmRuVTJwQlowVkJRVzlKUWtGUlEzUjNSSFZ6WVZsS1MybG1kM1FLUlRVeGVtbG9Ta2t5VkhaUFpFWm5hbFprZFV4aFZqZFhMM0VyTWpsTFV6RkRiUzk1WXpKU2RISm9jRXRyU2tVeloyUnFVRmx2Vkdwc0wzUlZjRzlGVWdwMWFGaE1TVWxGU1hwT01qUkhaazVOTlhOWE5sVnJTbnBIVlZSTGNYUnhZVzlrZW5sWE5rNXJPRkJqY1ZBMlptNWhaRmRtUkdad1JIRkhTV0UwU2psVUNrRkdWRE5NVVRSTFYzZEVVemRxYlRWbFQzZExZV0ZzU3pGdFNFNVZUM0JtYm1WUGNqQnRVRXBaWjNOek1GSkRRa3RWYjNkNVUwRTFjMGh0T0dweFZsWUtRek01VGxWc1UyTnJjVlZUTURCVU5XWjJSbXhCWVVZclVtMTZjRzlTTVdjM2NVNTRjSFJZZDFwamNqUXJSbVJYVEZZcmFWQXhPV2x4Ym1OeGNqaEVkQXBuVDNGb1NFNU5lbWx5ZEc5d1dWazFXV1ZNY1hGRk9FcEdTbE56Wm5STksxcFhlRUZGUjJwdmIwRktNVUZQYlhSNFZVZGpNMkptSzB4YVFrRkJZVFpXQ21OUGVsRlZSazVrUVdkTlFrRkJSVU5uWjBWQldWWlFiMWRYYWpBd2FHOHZVakpVVVdONFRYQnpUMHd5TjBkM2FHNTRSMDlJUzJKWGRVZHZUVTVrYTA4S2JHeGpWbHBIVDJSSmR6Z3JjbEIzVlZSR2NWRXZORW8xV0VOQlltRnJlVzE1YVRWS00xQkpSazVqTDBWa01HTmhSV0kzU0dwa2NHTllTM05RTjA1TlR3cENNR0ZoVWt0NGRXUTNSeTlWYTNjNFIzQlpabFZ4ZURaMmQwZEphWFpQSzJFM2EyOHplR2tyTXpkQloxbDNaVTVGUldOaVQyRXpPRnBsTlRJNVNraDBDbTQyYTJ4RldrdENlalJKVldJd1kzbFRSbHA0UjJ4NFRqTnBNbVpaZGtjclZWaGxibWRKVldRM05sRTNWR1o1Y1V4c1pqaHdTMEZOZFhoc2VYSkhWbllLWlhSV2JISlZTekpyVVRsUWIwRkljRVZPY2pGUmQxbFZPVWRXTVZsWVZYZEpaalo2UW1SeVlsbGtkbkZuT1RsTFUwRXZiek5JWlZGV01FUmxZa1pZY3dveWRtNDFPV2hMVERGbVV6TnFWUzlNZVdZNWFpODBhMWROVkV4eWMxWmpUa2hQVUVaM2NIZzBaMUZMUW1kUlJGUkxUVlp6TlhsUFN6TTNSa0Z6UVRWb0NqRlZLMHBwWTJwSldrb3JUakJ0YlM5RWFWUjBVM2x1YUU5SFZUY3ljbU53Vnl0WVFsbE5ja1Z0ZUhaV1Z6SnNUV1Z2YkRoQmNEY3paVXhOZVRKRFpsQUthVkJaUm1WMmExWk5iVk50UlVweE1GcGhkVlV6ZUZWcFVuWkhlamxUWWpaS05WQkJOMjUzTDJrd2Jtd3lPRWR1UkRKU1NWaFFNV1JDUkV0MVZFaDNSUXBJU0VjMVRIb3dRbk5PUkZGSFdqZFBlblZEVWtkNU16SjJVVXRDWjFGRVUzQmtXSEF6TTNkVlJWZGxaMkZGTW1GTGJrdElhSGh2Y25ka1N6TkRaR2RuQ25Jd1FXOVlSVTlKVUd4R1ZUQkZUVzlZVDJVeFVIVmxUR2xQYVZrNE5HbGhaM296VFhSc2RscDVTRlZSVFRKSFNFVkhaVmRHVkZKQ2RUaFhLM2RYWlZrS2FGTk1SV05XUW1SMVJVUnBRbEF3U2xSV2JVRXpiMjlMZWtzdmNVUXhTMkZ1VjJFNFdYb3paM0pNYjA1eFowMTVjMlI2YkVSS01Fb3ZjWEV5ZFN0eldRcHRSamszT1ZCQ2NFbFJTMEpuVVVSQk5XNW5hekp4Y25acVVtSkRaalZPUkRoTWFIVmllamRNVVhCRk16UkZZbGRWVEdWUVVqWkZSWEpLTldWd1dtMDFDalJOWm5Sa2REQkdObkZVYzNKcmRIUnZSM1pGY2tOb1NUZDVlbFptTHpSMVlUTktSVFF5YURBMGMzQnliM0pQVW5CWFpYWTBibEJQUlc0eGRqVnlPSEVLZFRoclVUaFZlakJTSzNwRldGcE9NV0ZIZHpKYWVYcFhUWEZYVWpoVVJrTkhSRWxVSzBsSFJUY3JRbmx0TVZWdGJraHpkVlpIVVZSRFVVdENaMFZ2ZEFwU05sTjRjRUp1VlM5NU4waFRMM2h5TUdsVVZHVkhNMDFPVVRGeWJFRllLMk5LVGtZeWFXOVNPVGhZYzBOS2IyZEVVMEZRTlVzeVNVdHdRV2gzWjNKWUNrTkdOR05KVlVGU2FrNWxSbTlIVWxaaVNWTXpUbk15YlRrM01YbHJZVFYwZHpRMU1XTktNWGRGY210RmJFczBMelZNUzNseGRESmxjM0IxZW1oYU1Ga0tja2RNVDJRMk1qQmFWbWRIWkVaWVdIVkVaVmxPTTNsaWFIcFpUaXR1TWxGMWNEaEdORGx5UWtGdlIwRkRVQ3N3YzJaTU1sUnlaV2t5V25GNFdGSnRjUXBzZVVSRU9HcHFjMjFaZHpSRWNFaGFkM04zY1NzMWVXUnVjbkJXWWk5eE1UQlZjVk13Y2pCdWREWnVjbk50VUVVeldWbHNLMEZrSzNOMmVtRnpaQ3RTQ20xUmNYcG9Sa0pwTDFONU5tNTBRemRFZEhKWVlUSmljWEZEUjNCblVFRXliRzFYUjFkNU9UbDRjVkZOWkZBNVNXZHdiMlpIY1drNFRHZFhkVUZZZHpRS0t6SXpRV2MwTDNsVVVuRlNUbHB0YkZoWVJVWlhjbU05Q2kwdExTMHRSVTVFSUZCU1NWWkJWRVVnUzBWWkxTMHRMUzBLCiAgICB0b2tlbjogQUR3Q0FiMXp5TEZLSnBReXJpWUpWNmpoYldEazhValkKLSBuYW1lOiB2YWdyYW50LWJhc2ljLWF1dGgKICB1c2VyOgogICAgcGFzc3dvcmQ6IFViajVqem4wQks5cFpsMU8KICAgIHVzZXJuYW1lOiBhZG1pbgo=`

func TestNewKubernetesClient(t *testing.T) {

	kc := getKubernetesClient()

	fmt.Println("Kub Client", kc)
	//c, err := kc.CreateContainer(&CreateContainerOptions{Image: "nginx", ImageVersion: "1.13.6"})

	// if err != nil {
	// 	panic(err)
	// }

	// j, err := json.Marshal(c)

	// if err != nil {
	// 	panic(err)
	// }

	// fmt.Printf("%v", string(j))

}

func TestCreateContainer(t *testing.T) {

}

func TestCreatePersistentVolume(t *testing.T) {
	kc := getKubernetesClient()
	pvo := &CreatePersistentVolumeOption{
		Path:         "/nfs/elasticshift",
		Server:       "10.10.3.128",
		MountOptions: []string{"hard", "nfsver=4.1"},
		provider:     NetworkFileShare,
		Name:         "pv-nfs-es",
		Capacity:     "5G",
	}
	res, err := kc.CreatePersistentVolume(pvo)

	if err != nil {
		panic(err)
	}

	fmt.Printf("Create Persistent Volume %v", res)
}

//func TestCreatePersistentVolumeHostDirectory(t *testing.T) {
//kc := getKubernetesClient()
//pvo := &CreatePersistentVolumeOption{
//Path:     "/Users/shahm/sandbox/es-nfs/hostpath",
//provider: HostLocalDirectory,
//}
//res, err := kc.CreatePersistentVolume(pvo)

//if err != nil {
//panic(err)
//}

//fmt.Printf("Create Persistent Volume %v", res)
//}

func getKubernetesClient() KubernetesClient {

	confBuf, err := base64.StdEncoding.DecodeString(confEncoded)
	if err != nil {
		fmt.Println("Error during kube initialization: ", err)
	}

	kco := &KubernetesClientOptions{KubeConfig: confBuf}
	// kco := &KubernetesClientOptions{KubeConfigFile: "/Users/ghazni/.kube/config"}
	//kco := &KubernetesClientOptions{KubeConfigFile: "$HOME/.kube/config"}
	kc, err := NewKubernetesClient(kco)
	if err != nil {
		fmt.Printf("Error from test run:  %v ", err)
	}

	fmt.Printf("%v", kc)
	r, _ := json.Marshal(kc)
	fmt.Printf("The Marshal string %v", string(r))
	return kc
}
